input: packages
output: .github/workflows/autogenerated-builder.yml

runs-on: ubuntu-latest
timeout: 360

overrides:
    guile2.0:
        build: false

    hipmagma:
        runs-on: self-hosted
        timeout: 1440

    openmp-extras:
        build: false

    python-pytorch-rocm:
        runs-on: self-hosted
        timeout: 1440

        pre-build-commands:
            - sed '/prepare()/a\  git config --global protocol.file.allow always' -i PKGBUILD
            - sed '/git submodule update/a\  sed "1i#include <mutex>" -i third_party/kineto/libkineto/src/RoctracerActivityApi.h' -i PKGBUILD
            - sed 's/79360/87773/g' -i PKGBUILD

    python-torchvision-rocm:
        runs-on: self-hosted
        timeout: 1440

        pre-build-commands:
            - echo 'export ROCM_HOME=/opt/rocm' >> PKGBUILD

    rccl:
        runs-on: self-hosted
        timeout: 1440

    rocblas:
        runs-on: self-hosted
        timeout: 1440

    rocfft:
        runs-on: self-hosted
        timeout: 1440

    rocm-developer-tools:
        build: false

    rocm-gdb:
        build: false

    rocm-llvm:
        runs-on: self-hosted
        timeout: 1444

    rocsolver:
        runs-on: self-hosted
        timeout: 1440
